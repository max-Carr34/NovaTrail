<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/admin-dashboard"></ion-back-button>
    </ion-buttons>
    <ion-title>Timelines - Children</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <!-- Statistics Bar -->
  <div class="stats-bar">
    <div class="stat-item">
      <span class="stat-number">{{ totalChildren }}</span>
      <div class="stat-label">Total Children</div>
    </div>
    <div class="stat-item">
      <span class="stat-number">{{ activeTimelines }}</span>
      <div class="stat-label">Active Timelines</div>
    </div>
    <div class="stat-item">
      <span class="stat-number">{{ recentEvents }}</span>
      <div class="stat-label">Recent Events</div>
    </div>
  </div>

  <!-- Search -->
  <div class="search-container">
    <div class="search-box">
      <ion-searchbar 
        [(ngModel)]="searchTerm" 
        (ionInput)="filterChildren()" 
        placeholder="Search by child's name or parent's name..."
        class="custom-searchbar">
      </ion-searchbar>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading">
    <ion-spinner name="crescent" class="custom-spinner"></ion-spinner>
    <p>Loading children's information...</p>
  </div>

  <!-- Error State -->
  <ion-card *ngIf="errorMessage" class="error-card">
    <ion-card-content>
      <ion-icon name="alert-circle-outline" class="error-icon"></ion-icon>
      <h3>Error loading data</h3>
      <p>{{ errorMessage }}</p>
      <ion-button (click)="retryLoad()" class="retry-btn" fill="outline">
        <ion-icon slot="start" name="refresh-outline"></ion-icon>
        Retry
      </ion-button>
    </ion-card-content>
  </ion-card>

  <!-- Children Grid -->
  <div *ngIf="!isLoading && !errorMessage && filteredChildren.length > 0" class="children-grid">
    <div *ngFor="let child of filteredChildren; trackBy: trackById" class="child-card">
      <div class="child-header">
        <div class="child-avatar">
          {{ getInitials(child.childName) }}
        </div>
        <div class="child-info">
          <h3>{{ child.childName }}</h3>
          <span class="child-age">{{ child.childAge }} years old</span>
        </div>
      </div>
      
      <div class="parent-info">
        <ion-icon name="person-outline"></ion-icon>
        <span>Parent: {{ child.parentName }}</span>
      </div>
      
      <div class="actions">
        <ion-button 
          (click)="goToAddEvent(child.child_id)" 
          class="action-btn btn-primary" 
          expand="block">
          <ion-icon slot="start" name="add-circle-outline"></ion-icon>
          Add Event
        </ion-button>

        <ion-button 
          (click)="goToTimeline(child.child_id)" 
          class="action-btn btn-secondary" 
          expand="block">
          <ion-icon slot="start" name="timeline-outline"></ion-icon>
          View Timeline
        </ion-button>
      </div>
    </div>
  </div>

  <!-- No Results -->
  <div *ngIf="!isLoading && !errorMessage && filteredChildren.length === 0" class="no-results">
    <ion-icon name="search-outline" class="no-results-icon"></ion-icon>
    <p>No results found for your search.</p>
  </div>
</ion-content>
